---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

interface Props {
	heading?: string;
	content?: string;
	backgroundColor?: "white" | "gray" | "blue" | "lime" | "dark-blue";
	maxWidth?: "narrow" | "medium" | "wide";
	imageSrc?: ImageMetadata;
	imageAlt?: string;
	imagePosition?: "left" | "right" | "top";
	padding?: "none" | "small" | "medium" | "large";
	headerPosition?: "top" | "bottom";
	class?: string;
}

const {
	heading,
	content = "",
	backgroundColor = "white",
	maxWidth = "medium",
	imageSrc,
	imageAlt = "",
	imagePosition = "right",
	padding = "large",
	headerPosition = "top",
	class: className,
} = Astro.props;

const bgClasses = {
	white: "bg-white",
	gray: "bg-gray-50",
	blue: "bg-blue-50",
	lime: "bg-primary-lime",
	"dark-blue": "bg-primary-blue text-white",
};

const paddingClasses = {
	none: "py-0",
	small: "py-8",
	medium: "py-12",
	large: "py-16",
};

const widthClasses = {
	narrow: "max-w-3xl",
	medium: "max-w-5xl",
	wide: "max-w-7xl",
};
---

<section
	class={`${paddingClasses[padding]} px-0 md:px-8 ${bgClasses[backgroundColor]} ${className || ""}`}
>
	<div class={`${widthClasses[maxWidth]} mx-auto`}>
		{
			heading && headerPosition === "top" && (
				<h2 class="text-3xl md:text-4xl font-bold text-primary-blue mb-6">
					{heading}
				</h2>
			)
		}

		{
			imageSrc && imagePosition === "top" && (
				<div class="mb-8 rounded-sm overflow-hidden shadow-lg">
					<Image
						src={imageSrc}
						alt={imageAlt}
						class="w-full h-auto object-cover"
						widths={[400, 768, 1024, 1280]}
						sizes="(max-width: 768px) 100vw, (max-width: 1024px) 768px, 1024px"
					/>
				</div>
			)
		}

		{
			heading && headerPosition === "bottom" && (
				<h2 class="text-3xl md:text-4xl font-bold text-primary-blue mb-6">
					{heading}
				</h2>
			)
		}

		{
			imageSrc && (imagePosition === "left" || imagePosition === "right") ? (
				<div
					class={`grid md:grid-cols-2 gap-8 items-center ${imagePosition === "left" ? "md:grid-flow-dense" : ""}`}
				>
					<div
						class={`text-lg max-w-none text-text-body leading-relaxed ${imagePosition === "left" ? "md:col-start-2" : ""}`}
					>
						<slot>
							{content && <p>{content}</p>}
						</slot>
					</div>
					<div
						class={`rounded-sm overflow-hidden shadow-lg ${imagePosition === "left" ? "md:col-start-1 md:row-start-1" : ""}`}
					>
						<Image
							src={imageSrc}
							alt={imageAlt}
							class="w-full h-auto object-cover"
							widths={[400, 600, 800]}
							sizes="(max-width: 768px) 100vw, 50vw"
						/>
					</div>
				</div>
			) : (
				<div class="max-w-none text-lg text-text-body leading-relaxed">
					<slot>
						{content && <p>{content}</p>}
					</slot>
				</div>
			)
		}
	</div>
</section>
